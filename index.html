<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- <meta name="viewport" content="width=device-width,initial-scale=1.0"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no"/>
    <title>vuecode</title>
  <style></style>
  <!-- <script src="./indexedOB.js"></script> -->
  <script>

  const PENDING = 'pending';
  const FULFILLED = 'fulfilled';
  const REJECTED = 'rejected';

  const NewPromise = function(executor) {
    const _this = this;
    _this.status = PENDING; // 状态
    _this.data = undefined; // 值
    _this.onResolvedCallback = []; // fulfilled的回调函数数组
    _this.onRejectedCallback = []; // rejected的回调函数数组

    // 成功
    function resolve(value) {
      // 只有pending状态才能转换为fulfilled / rejected
      setTimeout(function() { // 异步执行所有的回调函数
          if (_this.status === PENDING) {
              _this.status = FULFILLED;
              _this.data = value;
              _this.onResolvedCallback.forEach(callback => callback(value));
          }
      });
    }
    // 失败
    function reject(reason) {
      setTimeout(function() { // 异步执行所有的回调函数
          if (_this.status === PENDING) {
              _this.status = REJECTED;
              _this.data = reason;
              _this.onRejectedCallback.forEach(callback => callback(reason));
          }
      });
    }
  }
  const promise = new NewPromise(function(resolve, reject) {
    console.log('ss', 11)
  })
  
  console.log(promise)






  </script>
  </head>
  <body>

    
  </body>
</html>
