(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{383:function(a,t,s){"use strict";s.r(t);var r=s(43),e=Object(r.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"go-交叉编译"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#go-交叉编译"}},[a._v("#")]),a._v(" Go 交叉编译")]),a._v(" "),s("blockquote",[s("p",[a._v("https://blog.csdn.net/xingwangc2014/article/details/65013892")]),a._v(" "),s("p",[a._v("https://www.jianshu.com/p/0cf26a0c7e19")]),a._v(" "),s("p",[a._v("2017年03月22日")])]),a._v(" "),s("p",[a._v("Go在1.5版本中改进了对交叉编译的支持，包括统一了编译器、链接器等。从版本1.5开始，对你开发的应用程序进行夸平台交叉编译就变得相当简单了。只需要设置两个环境变量就可以搞定，分别是"),s("code",[a._v("GOOS")]),a._v("和"),s("code",[a._v("GOARCH")]),a._v("。")]),a._v(" "),s("h2",{attrs:{id:"环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境变量"}},[a._v("#")]),a._v(" 环境变量")]),a._v(" "),s("ul",[s("li",[s("p",[s("strong",[a._v("GOOS")]),a._v("：你的应用程序将要运行平台的操作系统（darwin、freebsd、linux、windows）")])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("GOARCH")]),a._v("：你的应用程序将要运行平台的处理器架构（386、amd64、arm） 。")])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("CGO_ENABLED")]),a._v("：交叉编译不支持 CGO 所以要禁用它。")])])]),a._v(" "),s("p",[a._v("有效的 "),s("code",[a._v("$GOOS")]),a._v(" 和 "),s("code",[a._v("$GOARCH")]),a._v(" 组合如下：")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[s("code",[a._v("$GOOS")])]),a._v(" "),s("th",[s("code",[a._v("$GOARCH")])])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("android")]),a._v(" "),s("td",[a._v("arm")])]),a._v(" "),s("tr",[s("td",[a._v("darwin")]),a._v(" "),s("td",[a._v("386")])]),a._v(" "),s("tr",[s("td",[a._v("darwin")]),a._v(" "),s("td",[a._v("amd64")])]),a._v(" "),s("tr",[s("td",[a._v("darwin")]),a._v(" "),s("td",[a._v("arm")])]),a._v(" "),s("tr",[s("td",[a._v("darwin")]),a._v(" "),s("td",[a._v("arm64")])]),a._v(" "),s("tr",[s("td",[a._v("dragonfly")]),a._v(" "),s("td",[a._v("amd64")])]),a._v(" "),s("tr",[s("td",[a._v("freebsd")]),a._v(" "),s("td",[a._v("386")])]),a._v(" "),s("tr",[s("td",[a._v("freebsd")]),a._v(" "),s("td",[a._v("amd64")])]),a._v(" "),s("tr",[s("td",[a._v("freebsd")]),a._v(" "),s("td",[a._v("arm")])]),a._v(" "),s("tr",[s("td",[a._v("linux")]),a._v(" "),s("td",[a._v("386")])]),a._v(" "),s("tr",[s("td",[a._v("linux")]),a._v(" "),s("td",[a._v("amd64")])]),a._v(" "),s("tr",[s("td",[a._v("linux")]),a._v(" "),s("td",[a._v("arm")])]),a._v(" "),s("tr",[s("td",[a._v("linux")]),a._v(" "),s("td",[a._v("arm64")])]),a._v(" "),s("tr",[s("td",[a._v("linux")]),a._v(" "),s("td",[a._v("ppc64")])]),a._v(" "),s("tr",[s("td",[a._v("linux")]),a._v(" "),s("td",[a._v("ppc64le")])]),a._v(" "),s("tr",[s("td",[a._v("linux")]),a._v(" "),s("td",[a._v("mips")])]),a._v(" "),s("tr",[s("td",[a._v("linux")]),a._v(" "),s("td",[a._v("mipsle")])]),a._v(" "),s("tr",[s("td",[a._v("linux")]),a._v(" "),s("td",[a._v("mips64")])]),a._v(" "),s("tr",[s("td",[a._v("linux")]),a._v(" "),s("td",[a._v("mips64le")])]),a._v(" "),s("tr",[s("td",[a._v("netbsd")]),a._v(" "),s("td",[a._v("386")])]),a._v(" "),s("tr",[s("td",[a._v("netbsd")]),a._v(" "),s("td",[a._v("amd64")])]),a._v(" "),s("tr",[s("td",[a._v("netbsd")]),a._v(" "),s("td",[a._v("arm")])]),a._v(" "),s("tr",[s("td",[a._v("openbsd")]),a._v(" "),s("td",[a._v("386")])]),a._v(" "),s("tr",[s("td",[a._v("openbsd")]),a._v(" "),s("td",[a._v("amd64")])]),a._v(" "),s("tr",[s("td",[a._v("openbsd")]),a._v(" "),s("td",[a._v("arm")])]),a._v(" "),s("tr",[s("td",[a._v("plan9")]),a._v(" "),s("td",[a._v("386")])]),a._v(" "),s("tr",[s("td",[a._v("plan9")]),a._v(" "),s("td",[a._v("amd64")])]),a._v(" "),s("tr",[s("td",[a._v("solaris")]),a._v(" "),s("td",[a._v("amd64")])]),a._v(" "),s("tr",[s("td",[a._v("windows")]),a._v(" "),s("td",[a._v("386")])]),a._v(" "),s("tr",[s("td",[a._v("windows")]),a._v(" "),s("td",[a._v("amd64")])])])]),a._v(" "),s("h2",{attrs:{id:"编译方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编译方式"}},[a._v("#")]),a._v(" 编译方式")]),a._v(" "),s("p",[a._v("如果要对应用程序进行跨平台编译，首先需要设置"),s("code",[a._v("GOOS")]),a._v("和"),s("code",[a._v("GOARCH")]),a._v("两个环境变量。然后编译方式同本平台编译方式相同。")]),a._v(" "),s("p",[a._v("所以进行夸平台编译，为便于理解拆分开来需要执行两个步骤：")]),a._v(" "),s("ol",[s("li",[a._v("设置 "),s("code",[a._v("GOOS")]),a._v(" 和 "),s("code",[a._v("GOARCH")]),a._v(" 两个环境变量")]),a._v(" "),s("li",[a._v("执行 "),s("code",[a._v("go build")])])]),a._v(" "),s("h2",{attrs:{id:"示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[a._v("#")]),a._v(" 示例")]),a._v(" "),s("p",[a._v("鉴于你可能需要编译多个平台的可执行程序，所以不建议你将GOOS和GOARCH两个环境变量在bashrc之类的文件中进行设置。")]),a._v(" "),s("p",[a._v("分两步操作也可能有点麻烦，你可以直接在一条命令中执行。如下：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("env")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("linux "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("arm go build -v github.com/constabulary/gb/cmd/gb\n")])])]),s("p",[a._v("你也可以进入到project的根目录下，而不用在命令行中指定需要编译的project：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("env")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("linux "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("arm go build "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n")])])]),s("p",[a._v("默认情况下go build会生成你package（project）名相同的可执行文件。如果你想指定生成的可执行文件的名字，需要使用-o选项：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("env")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("linux "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("arm go build -o test.bin "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n")])])]),s("h2",{attrs:{id:"其他平台的示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他平台的示例"}},[a._v("#")]),a._v(" 其他平台的示例")]),a._v(" "),s("p",[a._v("Mac 下编译 "),s("a",{attrs:{href:"https://link.jianshu.com/?t=http://lib.csdn.net/base/linux",target:"_blank",rel:"noopener noreferrer"}},[a._v("Linux"),s("OutboundLink")],1),a._v(" 和 Windows 64 位可执行程序")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("CGO_ENABLED")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("linux "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("amd64 go build \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("CGO_ENABLED")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("windows "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("amd64 go build \n")])])]),s("p",[s("a",{attrs:{href:"https://link.jianshu.com/?t=http://lib.csdn.net/base/linux",target:"_blank",rel:"noopener noreferrer"}},[a._v("linux"),s("OutboundLink")],1),a._v(" 下编译 Mac 和 Windows 64 位可执行程序")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("CGO_ENABLED")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("darwin "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("amd64 go build \n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("CGO_ENABLED")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("windows "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("amd64 go build \n")])])]),s("p",[a._v("Windows 下编译 Mac 和 Linux 64 位可执行程序")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("SET "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("CGO_ENABLED")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("0SET "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("darwinSET "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("amd64 go build main.go\nSET "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("CGO_ENABLED")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("0SET "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOOS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("linuxSET "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GOARCH")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("amd64 go build main.go\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("https://github.com/golang/go/blob/master/src/go/build/syslist.go"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#L8:31")]),a._v("\npackage build\nconst goosList "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"android darwin dragonfly freebsd js linux nacl netbsd openbsd plan9 solaris windows zos "')]),a._v("\nconst goarchList "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(' "386 amd64 amd64p32 arm armbe arm64 arm64be ppc64 ppc64le mips mipsle mips64 mips64le mips64p32 mips64p32le\n')])])]),s("h2",{attrs:{id:"参考链接："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考链接："}},[a._v("#")]),a._v(" 参考链接：")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://golang.org/doc/install/source#environment",target:"_blank",rel:"noopener noreferrer"}},[a._v("Go Optional environment variables"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://dave.cheney.net/2015/08/22/cross-compilation-with-go-1-5",target:"_blank",rel:"noopener noreferrer"}},[a._v("Cross Compile with Go 1.5"),s("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);